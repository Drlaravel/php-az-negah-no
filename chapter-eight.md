<div dir="rtl" style="font-family: 'Vazir', sans-serif; line-height: 1.8;">
---

### فصل هشتم: کار با فایل‌ها

---

## 8.1 معرفی کار با فایل‌ها

یکی از وظایف رایج در برنامه‌نویسی، مدیریت فایل‌ها است. PHP ابزارهای قدرتمندی برای خواندن، نوشتن و دستکاری فایل‌ها ارائه می‌دهد. در این فصل، با نحوه کار با فایل‌ها در PHP آشنا خواهید شد.

## 8.2 خواندن و نوشتن فایل‌ها

### 8.2.1 باز کردن فایل‌ها با `fopen()`

برای کار با فایل‌ها در PHP، ابتدا باید فایل را باز کنید. این کار با استفاده از تابع `fopen()` انجام می‌شود که به دو پارامتر نیاز دارد: نام فایل و حالت باز کردن فایل (خواندن، نوشتن، اضافه کردن و غیره).

```php
<?php
$فایل = fopen("example.txt", "r"); // باز کردن فایل در حالت خواندن
?>
```

### 8.2.2 خواندن فایل‌ها با `fread()`

تابع `fread()` برای خواندن محتوای فایل استفاده می‌شود. این تابع دو پارامتر می‌گیرد: اشاره‌گر فایل و تعداد بایت‌هایی که باید خوانده شود.

```php
<?php
$فایل = fopen("example.txt", "r");
$محتوا = fread($فایل, filesize("example.txt"));
echo $محتوا;
fclose($فایل);
?>
```

### 8.2.3 نوشتن در فایل‌ها با `fwrite()`

برای نوشتن در یک فایل، می‌توانید از تابع `fwrite()` استفاده کنید. این تابع دو پارامتر می‌گیرد: اشاره‌گر فایل و محتوایی که باید نوشته شود.

```php
<?php
$فایل = fopen("example.txt", "w");
fwrite($فایل, "این یک متن نمونه است.");
fclose($فایل);
?>
```

### 8.2.4 اضافه کردن به فایل‌ها با `fwrite()`

برای اضافه کردن محتوا به انتهای یک فایل، باید فایل را در حالت اضافه (`a`) باز کنید.

```php
<?php
$فایل = fopen("example.txt", "a");
fwrite($فایل, "این یک خط جدید است.");
fclose($فایل);
?>
```

## 8.3 مدیریت فایل‌ها

### 8.3.1 بررسی وجود فایل با `file_exists()`

این تابع بررسی می‌کند که آیا یک فایل یا دایرکتوری وجود دارد یا خیر.

```php
<?php
if (file_exists("example.txt")) {
    echo "فایل موجود است.";
} else {
    echo "فایل وجود ندارد.";
}
?>
```

### 8.3.2 حذف فایل‌ها با `unlink()`

تابع `unlink()` برای حذف یک فایل استفاده می‌شود.

```php
<?php
if (file_exists("example.txt")) {
    unlink("example.txt");
    echo "فایل حذف شد.";
} else {
    echo "فایل برای حذف وجود ندارد.";
}
?>
```

### 8.3.3 تغییر نام فایل‌ها با `rename()`

تابع `rename()` برای تغییر نام یک فایل یا جابجایی آن به یک مسیر جدید استفاده می‌شود.

```php
<?php
rename("old_name.txt", "new_name.txt");
?>
```

## 8.4 آپلود فایل‌ها

PHP به شما اجازه می‌دهد تا فایل‌ها را از طریق فرم‌های HTML آپلود کنید. برای این کار، ابتدا باید فرم HTML را آماده کنید:

```html
<form action="upload.php" method="post" enctype="multipart/form-data">
    انتخاب فایل:
    <input type="file" name="fileToUpload">
    <input type="submit" value="آپلود">
</form>
```

در فایل PHP، می‌توانید فایل آپلود شده را مدیریت کنید:

```php
<?php
$target_dir = "uploads/";
$target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
$uploadOk = 1;

if (move_uploaded_file($_FILES["fileToUpload"]["tmp_name"], $target_file)) {
    echo "فایل ". basename($_FILES["fileToUpload"]["name"]). " آپلود شد.";
} else {
    echo "مشکلی در آپلود فایل رخ داد.";
}
?>
```

## 8.5 کار با فایل‌های JSON و XML

### 8.5.1 کار با فایل‌های JSON

PHP دارای توابعی برای خواندن و نوشتن داده‌ها در فرمت JSON است.

- **خواندن JSON از فایل**:
  
  ```php
  <?php
  $jsonData = file_get_contents("data.json");
  $arrayData = json_decode($jsonData, true);
  ?>
  ```

- **نوشتن JSON در فایل**:
  
  ```php
  <?php
  $arrayData = array("name" => "Ali", "age" => 25);
  $jsonData = json_encode($arrayData);
  file_put_contents("data.json", $jsonData);
  ?>
  ```

### 8.5.2 کار با فایل‌های XML

PHP از کتابخانه‌های ساده‌ای برای پردازش XML پشتیبانی می‌کند.

- **خواندن XML از فایل**:
  
  ```php
  <?php
  $xml = simplexml_load_file("data.xml");
  echo $xml->name;
  ?>
  ```

- **نوشتن XML در فایل**:
  
  ```php
  <?php
  $xml = new SimpleXMLElement('<root/>');
  $xml->addChild("name", "Ali");
  $xml->asXML("data.xml");
  ?>
  ```

---

## تمرین‌های فصل هشتم

1. **خواندن و نمایش فایل**: یک فایل متنی ایجاد کنید و سپس با استفاده از `fopen()` و `fread()` محتوای آن را در مرورگر نمایش دهید.

2. **نوشتن در فایل**: یک فایل جدید ایجاد کنید و با استفاده از `fwrite()`، یک پیام دلخواه در آن بنویسید.

3. **اضافه کردن به فایل**: به یک فایل موجود، یک خط جدید اضافه کنید.

4. **بررسی وجود فایل**: بررسی کنید که آیا یک فایل با نام مشخص وجود دارد یا خیر و در صورت وجود، پیام مناسبی نمایش دهید.

5. **آپلود فایل**: یک فرم HTML برای آپلود فایل بسازید و فایل آپلود شده را به یک پوشه مشخص در سرور انتقال دهید.

6. **کار با JSON**: یک فایل JSON بسازید که شامل اطلاعات یک شخص باشد و سپس آن را بخوانید و در مرورگر نمایش دهید.

---

## خلاصه فصل هشتم

در این فصل، با نحوه کار با فایل‌ها در PHP آشنا شدید. شما یاد گرفتید که چگونه فایل‌ها را باز، خوانده و در آن‌ها بنویسید. همچنین بررسی وجود، حذف و تغییر نام فایل‌ها را آموختید. در نهایت، با نحوه آپلود فایل‌ها از طریق فرم‌های HTML و کار با فایل‌های JSON و XML آشنا شدید. مدیریت فایل‌ها یکی از مهم‌ترین بخش‌های برنامه‌نویسی کاربردی است و در این فصل، مهارت‌های لازم برای کار با فایل‌ها در PHP را به دست آوردید.

</div>

