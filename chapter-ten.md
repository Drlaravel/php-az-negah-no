<div dir="rtl" style="font-family: 'Vazir', sans-serif; line-height: 1.8;">

---

### فصل دهم: تعامل با فرم‌ها و وب

---

## 10.1 معرفی فرم‌ها در PHP

فرم‌ها یکی از ابزارهای اصلی برای ارتباط کاربران با وب‌سایت‌ها هستند. با استفاده از فرم‌ها، کاربران می‌توانند داده‌ها را وارد کرده و به سرور ارسال کنند تا پردازش شوند.

## 10.2 ایجاد فرم‌های HTML

برای ایجاد یک فرم در HTML، از تگ `<form>` استفاده می‌شود. فرم‌ها شامل فیلدهای ورودی مختلفی مانند متن، رمز عبور، دکمه‌های رادیویی، چک‌باکس‌ها و دکمه‌های ارسال هستند.

### 10.2.1 فرم ساده

```html
<form action="process.php" method="post">
    نام: <input type="text" name="name"><br>
    ایمیل: <input type="email" name="email"><br>
    <input type="submit" value="ارسال">
</form>
```

## 10.3 پردازش فرم‌ها در PHP

هنگامی که کاربر فرم را ارسال می‌کند، داده‌ها به اسکریپت PHP ارسال شده و می‌توان آن‌ها را پردازش کرد.

### 10.3.1 دریافت داده‌ها با `$_POST` و `$_GET`

برای دریافت داده‌های ارسال شده از فرم، از آرایه‌های فوق‌جهانی `$_POST` و `$_GET` استفاده می‌شود:

```php
<?php
$نام = $_POST['name'];
$ایمیل = $_POST['email'];
echo "نام: $نام<br>";
echo "ایمیل: $ایمیل<br>";
?>
```

## 10.4 اعتبارسنجی داده‌ها

اعتبارسنجی داده‌های ورودی کاربران بسیار مهم است تا از ورود داده‌های نامعتبر یا مخرب جلوگیری شود.

### 10.4.1 بررسی خالی بودن فیلدها

```php
<?php
if (empty($_POST['name'])) {
    echo "نام نمی‌تواند خالی باشد.";
} else {
    echo "نام: " . $_POST['name'];
}
?>
```

### 10.4.2 بررسی فرمت ایمیل

```php
<?php
if (!filter_var($_POST['email'], FILTER_VALIDATE_EMAIL)) {
    echo "فرمت ایمیل نامعتبر است.";
} else {
    echo "ایمیل معتبر است.";
}
?>
```

## 10.5 ارسال و دریافت اطلاعات با GET و POST

### 10.5.1 ارسال اطلاعات با GET

اطلاعات ارسال شده با متد `GET` در URL نمایش داده می‌شوند و برای داده‌های حساس مناسب نیستند.

```html
<form action="process.php" method="get">
    نام: <input type="text" name="name">
    <input type="submit" value="ارسال">
</form>
```

### 10.5.2 ارسال اطلاعات با POST

اطلاعات ارسال شده با متد `POST` در URL نمایش داده نمی‌شوند و برای داده‌های حساس مناسب‌تر هستند.

```html
<form action="process.php" method="post">
    نام: <input type="text" name="name">
    <input type="submit" value="ارسال">
</form>
```

## 10.6 کار با کوکی‌ها و سشن‌ها (Cookies and Sessions)

### 10.6.1 ایجاد و استفاده از کوکی‌ها

کوکی‌ها اطلاعات کوچکی هستند که در مرورگر کاربر ذخیره می‌شوند.

- **ایجاد کوکی**:

  ```php
  <?php
  setcookie("username", "Ali", time() + (86400 * 30), "/");
  ?>
  ```

- **دسترسی به کوکی**:

  ```php
  <?php
  if(isset($_COOKIE["username"])) {
      echo "نام کاربری: " . $_COOKIE["username"];
  } else {
      echo "کوکی تنظیم نشده است.";
  }
  ?>
  ```

### 10.6.2 ایجاد و استفاده از سشن‌ها

سشن‌ها اطلاعات را در سمت سرور ذخیره می‌کنند و تا زمان بسته شدن مرورگر یا پایان یافتن سشن فعال باقی می‌مانند.

-

 **شروع سشن**:

  ```php
  <?php
  session_start();
  $_SESSION["username"] = "Ali";
  ?>
  ```

- **دسترسی به سشن**:

  ```php
  <?php
  session_start();
  echo "نام کاربری: " . $_SESSION["username"];
  ?>
  ```

## 10.7 امنیت در فرم‌ها

### 10.7.1 محافظت در برابر CSRF

CSRF (Cross-Site Request Forgery) نوعی حمله است که مهاجم با ارسال درخواست‌های غیرمجاز به یک وب‌سایت انجام می‌دهد. برای محافظت در برابر CSRF، می‌توانید از توکن‌های CSRF استفاده کنید.

- **ایجاد توکن CSRF**:

  ```php
  <?php
  session_start();
  $csrf_token = bin2hex(random_bytes(32));
  $_SESSION['csrf_token'] = $csrf_token;
  ?>
  ```

- **استفاده از توکن در فرم**:

  ```html
  <form action="process.php" method="post">
      <input type="hidden" name="csrf_token" value="<?php echo $_SESSION['csrf_token']; ?>">
      نام: <input type="text" name="name">
      <input type="submit" value="ارسال">
  </form>
  ```

- **اعتبارسنجی توکن**:

  ```php
  <?php
  session_start();
  if ($_POST['csrf_token'] === $_SESSION['csrf_token']) {
      // پردازش فرم
  } else {
      echo "درخواست نامعتبر است.";
  }
  ?>
  ```

### 10.7.2 محافظت در برابر XSS

XSS (Cross-Site Scripting) نوعی حمله است که مهاجم با تزریق کدهای مخرب به صفحات وب انجام می‌دهد. برای جلوگیری از XSS، باید داده‌های کاربر را پیش از نمایش در صفحه پاک‌سازی کنید.

- **پاک‌سازی داده‌ها**:

  ```php
  <?php
  $name = htmlspecialchars($_POST['name'], ENT_QUOTES, 'UTF-8');
  echo "نام: " . $name;
  ?>
  ```

---

## تمرین‌های فصل دهم

1. **ایجاد یک فرم ساده**: یک فرم HTML ایجاد کنید که شامل نام و ایمیل کاربر باشد و اطلاعات را با متد `POST` به یک اسکریپت PHP ارسال کند.

2. **اعتبارسنجی فرم**: یک اسکریپت PHP بنویسید که اطلاعات ورودی از یک فرم را اعتبارسنجی کرده و در صورت نامعتبر بودن، پیام مناسبی نمایش دهد.

3. **کار با کوکی‌ها**: یک اسکریپت بنویسید که نام کاربری کاربر را در یک کوکی ذخیره کرده و سپس در صفحه بعدی نمایش دهد.

4. **کار با سشن‌ها**: یک سشن برای ذخیره نام کاربری کاربر ایجاد کنید و سپس آن را در صفحه دیگری نمایش دهید.

5. **محافظت در برابر CSRF**: یک فرم ساده ایجاد کنید که شامل یک توکن CSRF باشد و سپس در سمت سرور، این توکن را اعتبارسنجی کنید.

6. **محافظت در برابر XSS**: داده‌های ورودی کاربر را پیش از نمایش در صفحه با استفاده از `htmlspecialchars()` پاک‌سازی کنید.

---

## خلاصه فصل دهم

در این فصل، با تعامل فرم‌ها و وب در PHP آشنا شدید. شما یاد گرفتید که چگونه فرم‌های HTML ایجاد کنید و داده‌های آن‌ها را با استفاده از متدهای `GET` و `POST` پردازش کنید. همچنین با نحوه اعتبارسنجی داده‌های ورودی و استفاده از کوکی‌ها و سشن‌ها برای مدیریت داده‌ها آشنا شدید. در نهایت، اصول امنیتی مانند محافظت در برابر CSRF و XSS را بررسی کردید. تعامل با فرم‌ها و مدیریت داده‌ها از طریق وب، بخش مهمی از توسعه وب‌سایت‌ها است و در این فصل، مهارت‌های لازم برای کار با فرم‌ها در PHP را به دست آوردید.

---
</div>